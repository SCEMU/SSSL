# **Практика №4 по предмету СДССиЛ - Network Threat Hunting**
Выполнил студент: Сидоренков Никита Дмитриевич 


Группы: ББМО-02-23

## **Шаг 1. Развертывание ВМ и запуск стенда:**
### **Скачанная и запущенная ВМ:**
![Снимок1](https://github.com/user-attachments/assets/f069082c-9723-4f96-af2e-eefd00c389fd)

### **Web-интерфейс развернутого стенда:**
![Снимок3](https://github.com/user-attachments/assets/6ee9b9bc-1610-4745-b627-7c1f986f5d72)

### **Выбор датасета для работы:**
![Снимок2](https://github.com/user-attachments/assets/87363ed8-f170-4614-98d7-6255fd0652fc)

### **Стартовая страница после аутентификации и выбора датасета развернутого стенда:**
![Снимок](https://github.com/user-attachments/assets/ed5175fe-82c7-4fe8-848d-ae1312efad3a)

### **Пример добавления адреса в safelist (skype.com):**
#### **Переходим в модуль beacons web:**
![Снимок4](https://github.com/user-attachments/assets/76fbef23-49c2-4807-b13e-5040da7c39b0)

#### **Выбор нужного адреса:**
![Снимок5](https://github.com/user-attachments/assets/17f01b57-03b0-4a9a-94dc-08a9cb8f30d6)

#### **Добавление адреса в safelist:**
![Снимок6](https://github.com/user-attachments/assets/e5528f49-43ec-415b-b3af-490a01a106db)

### **Проверка safelist на наличие добавленного ранее адреса:**
![Снимок7](https://github.com/user-attachments/assets/2c838ad1-d9ec-440e-8839-4f06db7799ca)

## **Шаг 2. Выполнение заданий из lab1:**
### **Переход в нужную директорию и импорт логов:**
![Снимок8](https://github.com/user-attachments/assets/1be78d2e-215f-4b90-877d-990d6c4c9b28)

### **Переключение на нужный датасет с загруженными ранее логами в web-итерфейсе:**
![Снимок9](https://github.com/user-attachments/assets/40c01eee-7126-494f-a885-27fd6abfb74a)

### **Стартовая страница с обнаруженными адресами и beacon score:**
![Снимок10](https://github.com/user-attachments/assets/7303c0e6-e9e3-4c62-b05d-645a5d206f0a)

### **Переход в beacons web для анализа адресов:**
![Снимок11](https://github.com/user-attachments/assets/25949ffc-df04-4660-b5c3-6ffaeaec14e9)

### **Проверка первого адреса:**
![Screenshot_1](https://github.com/user-attachments/assets/d289a73e-b437-418d-b5fd-ee1f1b929e21)

**Вывод по адресу** - Адрес проявляет подозрительную активность из-за количества подключений (3011), а также стабильности и прямолинейности графика зависимости количества подключений ко времени. Также не отображается полное доменное имя хоста, что может говорить о его вредоносности.

### **Проверка остальных адресов (для примера разберем 2 и 3 адреса):**
![Screenshot_7](https://github.com/user-attachments/assets/2102010c-f014-44af-b25f-50ea361cf279)
![Screenshot_8](https://github.com/user-attachments/assets/a7a4ca56-f0cc-4a33-9f4e-7e6a1fe1ef09)

**Вывод по адресам** - Два адреса и все последующие из списка относятся к компонентам и программам microsoft и вызывают доверие. Так же они не обладают большим количествам подключений. Из этого можно сделать вывод что данные адреса безопасны. Добавим по примеру, описанному выше, данные адреса в safelist

### **Проверка отображения добавленных ранее безопасных адресов в safelist:**
![Screenshot_9](https://github.com/user-attachments/assets/bbceac02-a6b9-4833-bcc0-e1e0e5f97961)

### **Переход к модулю long connections:**
![Screenshot_10](https://github.com/user-attachments/assets/5c02a7ba-76dc-4f70-9beb-a25ff5a8675f)

В данном окне видим два адреса, проверим каждый из них

### **Проверим адрес №1 на ресурсе VirusTotal**
![Screenshot_12](https://github.com/user-attachments/assets/75f0e3e2-4d47-4110-a792-4a04f62fa6c0)

**Вывод по адресу** - Адрес имеет на данном ресурсе отметку о вредоносности (1 вендор отметил этот адрес как вредоносный)

### **Проверим адрес №1 на ресурсе AbuselPDB**
![Screenshot_13](https://github.com/user-attachments/assets/f8842a5e-7a68-4fc4-ad66-dd6a8c0341ef)

**Вывод по адресу** - Адрес имеет на данном ресурсе отметки о вредоносности (2 раза данный адрес был зарепорчен как вредоносный)

### **Проверим адрес №2 на ресурсе VirusTotal**
![Screenshot_14](https://github.com/user-attachments/assets/12b9d453-fd41-4843-88e8-4c0310aaa326)

**Вывод по адресу** - Адрес не имеет на данном ресурсе отметку о вредоносности.

### **Вывод по lab1** - Соединения с IP-адресом 167.71.97.235 вызывают подозрения: зафиксировано 3011 соединений с высоким значением beacons score, отсутствует поле «хост» в HTTP-заголовке. Кроме того, имеются несколько отчетов о вредоносной активности, связанной с этим адресом. Остальные адреса считаются безопасными, что подтверждается проведенным анализом

## **Шаг 3. Выполнение заданий из lab2:**
### **Переход в нужную директорию и импорт логов:**
![Screenshot_15](https://github.com/user-attachments/assets/5ca49e7d-0caf-44ba-9d0f-18d9dc3884f6)

### **Переключимся на нужный датасет с загруженными ранее логами в web-итерфейсе:**
### **Стартовая страница (пустая):**
![Screenshot_16](https://github.com/user-attachments/assets/a508d32e-abcc-4e8c-a3df-6b186746ed42)

### **Переход в моудль DNS:**
![Screenshot_17](https://github.com/user-attachments/assets/52f7ced4-ab92-47e1-8774-2d64059035f0)
![Screenshot_18](https://github.com/user-attachments/assets/379146b0-38fe-4a51-a9ef-d424f330c5cf)

### **Вывод по lab2:** - Анализ показывает, что была предпринята попытка атаки с использованием протокола C2 через DNS. Вероятно, использовалась утилита dnscat2, разработанная Роном Боузом, которая позволяет создавать командно-контрольные каналы (C&C) через DNS. Длина и имена поддоменов также вызывает подозрения, так как они выглядят как случайно сгенерированные (DGA). Кроме того, зафиксировано аномально большое количество запросов к одному домену — 2074

## **Шаг 4. Выполнение заданий из lab3:**
### **Переход в нужную директорию и импорт логов:**
![Screenshot_19](https://github.com/user-attachments/assets/50aeda5f-66d9-4e92-8ff8-6b9dc2b62b1f)

### **Переключение на нужный датасет с загруженными ранее логами в web-итерфейсе:**
![Screenshot_20](https://github.com/user-attachments/assets/9b6f9666-6775-4ed1-b588-32750450783e)

### **Стартовая страница:**
![Screenshot_21](https://github.com/user-attachments/assets/6b5b7cff-3520-4d53-a34d-da50d1cc0469)

### **Переход в моудль beacons web:**
![Screenshot_22](https://github.com/user-attachments/assets/3754cc94-6094-4541-a21e-7d0ff84a6aca)

### **После анализа по примеру lab1 найден данный подозрительный адрес:**
![Screenshot_22](https://github.com/user-attachments/assets/806bc051-f29c-4364-9a0f-65a49fd1d475)

### **Проверка странного домена, похожего на skype с помощью ресурса VirusTotal:**
![Screenshot_24](https://github.com/user-attachments/assets/802b70b9-0455-4091-8bfb-9405afab20e0)

**Вывод по адресу** - Адрес явно опасен из-за количества связей и очень стабильного графика подключений ко времени, а также после проверки домена понятно что это вредоносный ресурс

### **Переход к модулю long connections:**
![Screenshot_25](https://github.com/user-attachments/assets/bc04c2d9-4ff9-4cd7-9ecd-3f2311d37ccb)

**Вывод** - модуль показывает аналогичные данные и адреса с данными в lab1. Следовательно первый адрес вредоносен

### **Вывод по lab3** - Под подозрение о вредоносности попадает первый адрес. Странное название хоста, явно сгенерированное на подобии домена skype. Также сервис для проверки отметил пять раза его вредоносность. Также о вредоносности может говорить количество детекций соединений на один адрес, число которых очень большое.









